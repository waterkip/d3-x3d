<!DOCTYPE html>
<html>

<head>
  <title>d3-x3d : 3D Scatter Plot Example</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://x3dom.org/download/dev/x3dom-full.js"></script>
  <link rel="stylesheet" href="https://x3dom.org/download/dev/x3dom.css" />
  <script src="../../dist/d3-x3d.js"></script>
</head>

<body>
  <div id="chartholder"></div>

  <script>
    function loadChart(data) {
      // Select chartholder
      var chartHolder = d3.select("#chartholder");

      // Declare the chart component
      var myChart = d3.x3d.chart.scatterPlot()
        //.colors(d3.schemeRdYlGn[8]);
        .sizeRange([0.05, 3]);

      // Generate chart
      chartHolder.datum(data).call(myChart);
    }


    // Generate Chart from Random Data
    // var randomData = d3.x3d.randomData.dataset3(200);
    // console.log(randomData);
    // loadChart(randomData);


    // Generate Chart fro Pollen CSV Data
    // Source: http://metagrid2.sv.vt.edu/~npolys/InfoVis2019/pollen.csv
    d3.csv("pollen.csv")
      .then((data) => {
        // console.log(data);

        var points = data.map((d) => {
          var key = 'Point' + d.OBSERVATION_NUMBER;
          var ridge = +d.RIDGE;
          var nub = +d.NUB;
          var crack = +d.CRACK;
          var weight = +d.WEIGHT;
          var density = +d.DENSITY;

          return {
            key: key,
            value: density,
            x: ridge,
            y: nub,
            z: crack
          };
        });
        // console.log(points);

        var pollenData = {
          key: 'Pollen',
          values: points
        };

        loadChart(pollenData);
      })
      .finally(() => {
        x3dom.reload();
      });

  </script>
</body>
